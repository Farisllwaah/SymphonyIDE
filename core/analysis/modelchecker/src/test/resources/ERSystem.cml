types
	SystemID = <CC> | <RS> | <ERU> | <MPS>

channels
	start_rescue, find_idle_erus, allocate_idle_eru, send_rescue_info_to_eru,
	divert_eru, log_diversion, wait, fault_1_activation, 
	drop_message, error_1_detection, target_not_attended, start_recovery_1,
	end_recovery_1, service_rescue, log_fault_1, resend_rescue_info_to_eru
	idle_eru: bool 
	
	process_message, receive_message: SystemID
	
chansets
	H = {| start_recovery_1, end_recovery_1, log_fault_1, 
			resend_rescue_info_to_eru, error_1_detection |}
	E = F union {| drop_message, target_not_attended |}
	F = {| fault_1_activation |}
	RecoverySignals = {| start_recovery_1, end_recovery_1 |}
	Alpha_ERSystem = 
	{|
		start_rescue, find_idle_erus, allocate_idle_eru, send_rescue_info_to_eru,
		divert_eru, log_diversion, wait, fault_1_activation, 
		drop_message, error_1_detection, target_not_attended, start_recovery_1,
		end_recovery_1, service_rescue, log_fault_1, resend_rescue_info_to_eru,
		idle_eru, process_message, receive_message
	|}
	
process InitiateRescueFault1Activation = 
begin
	actions
		CallCentreStart = StartRescue
		StartRescue = start_rescue -> FindIdleEru
		FindIdleEru = find_idle_erus -> idle_eru?idle ->
			if idle=true then IdleEru else NoIdleEru
		IdleEru = allocate_idle_eru -> SendInfo
		SendInfo = send_rescue_info_to_eru -> IR1
		IR1 = (process_message!<RS> -> IR1Out) [] IR1Event
		IR1Out = CCReceiveMessage
		IR1Event = fault_1_activation -> IR2
		CCReceiveMessage = receive_message!<RS> -> ServiceRescue
		ServiceRescue = service_rescue -> CallCentreStart
		IR2 = (IR2Out) [] IR2Event
		IR2Out = drop_message -> target_not_attended -> CallCentreStart
		IR2Event = error_1_detection -> CCStartRecovery
		NoIdleEru = wait -> FindIdleEru
		CCStartRecovery = start_recovery_1 -> CCEndRecovery
		CCEndRecovery = end_recovery_1 -> ServiceRescue
	@ CallCentreStart
end

process Recovery1 =
begin
	actions
		Recovery1Start = start_recovery_1 -> Log
		Log = log_fault_1 -> Resend
		Resend = resend_rescue_info_to_eru -> MPSProcessMessage
		MPSProcessMessage = process_message!<MPS> -> MPSReceiveMessage
		MPSReceiveMessage = receive_message!<MPS> -> MPSEnd
		MPSEnd = end_recovery_1 -> Recovery1Start
	@ Recovery1Start
end 

process ERSystem = 
	InitiateRescueFault1Activation [|RecoverySignals|] Recovery1
	
/*process ERSystemFT = 
	InitiateRescueFault1Activation [|RecoverySignals|] 
	(Recovery1 [[ process_message.<MPS> <- process_message.<RS>,
					receive_message.<MPS> <- receive_message.<RS> ]])
					*/